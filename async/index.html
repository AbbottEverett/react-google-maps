<!DOCTYPE html><html><head><title>Async | React Google Maps | tomchentw</title><base href="../"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta charset="UTF-8"/><link rel="stylesheet" href="assets/client-async-6d9aa0d9aa43f1079e36.css"/><script type="text/javascript" src="https://cdn.jsdelivr.net/prism/1.4.1/prism.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/prism/1.4.1/components/prism-jsx.min.js"></script></head><body><div id="react-container"><div id="react-root" data-reactid=".2fn19shzwg0" data-react-checksum="-1118904869"><nav class="navbar navbar-default" role="navigation" data-reactid=".2fn19shzwg0.0"><div class="container-fluid" data-reactid=".2fn19shzwg0.0.0"><div class="navbar-header" data-reactid=".2fn19shzwg0.0.0.0"><button type="button" class="navbar-toggle collapsed" data-reactid=".2fn19shzwg0.0.0.0.0"><span class="sr-only" data-reactid=".2fn19shzwg0.0.0.0.0.0">Toggle navigation</span><span class="icon-bar" data-reactid=".2fn19shzwg0.0.0.0.0.1"></span><span class="icon-bar" data-reactid=".2fn19shzwg0.0.0.0.0.2"></span><span class="icon-bar" data-reactid=".2fn19shzwg0.0.0.0.0.3"></span></button><a class="navbar-brand" href="#" data-reactid=".2fn19shzwg0.0.0.0.1">React Google Maps</a></div><div class="collapse navbar-collapse" data-reactid=".2fn19shzwg0.0.0.1"><ul class="nav navbar-nav" data-reactid=".2fn19shzwg0.0.0.1.0"><li data-reactid=".2fn19shzwg0.0.0.1.0.0"><a href="https://github.com/tomchentw" target="_blank" data-reactid=".2fn19shzwg0.0.0.1.0.0.0">by @tomchentw</a></li><li class="active" data-reactid=".2fn19shzwg0.0.0.1.0.1:$async-loader-getting-started"><a href="#async-loader-gs" data-reactid=".2fn19shzwg0.0.0.1.0.1:$async-loader-getting-started.0">Async Loader - Getting Started</a></li></ul><ul class="nav navbar-nav navbar-right" style="margin-right:100px;" data-reactid=".2fn19shzwg0.0.0.1.1"><li data-reactid=".2fn19shzwg0.0.0.1.1.0"><a href="async/" data-reactid=".2fn19shzwg0.0.0.1.1.0.0">Async Example</a></li></ul></div></div></nav><div class="container-fluid container--full-height" data-reactid=".2fn19shzwg0.1"><div class="github-fork-ribbon-wrapper right" style="width:150px;height:150px;position:absolute;overflow:hidden;top:0px;z-index:9999;pointer-events:none;right:0px;" data-reactid=".2fn19shzwg0.1.0"><div class="github-fork-ribbon" style="position:absolute;padding:2px 0;background-color:#333;background-image:linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));-webkit-box-shadow:0 2px 3px 0 rgba(0, 0, 0, 0.5);-moz-box-shadow:0 2px 3px 0 rgba(0, 0, 0, 0.5);box-shadow:0 2px 3px 0 rgba(0, 0, 0, 0.5);font:700 13px &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;z-index:9999;pointer-events:auto;top:42px;right:-43px;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg);" data-reactid=".2fn19shzwg0.1.0.0"><a href="https://github.com/tomchentw/react-google-maps" style="color:#fff;text-decoration:none;text-shadow:0 -1px rgba(0, 0, 0, 0.5);text-align:center;width:200px;line-height:20px;display:inline-block;padding:2px 0;border-width:1px 0;border-style:dotted;border-color:rgba(255, 255, 255, 0.7);" data-reactid=".2fn19shzwg0.1.0.0.0">Fork me on GitHub</a></div></div><div id="toast-container" aria-live="polite" role="alert" data-reactid=".2fn19shzwg0.1.1"></div><div class="row row--full-height" data-reactid=".2fn19shzwg0.1.2"><div class="col-xs-6" style="height:100%;" data-reactid=".2fn19shzwg0.1.2.0"><svg fill="currentColor" width="1em" height="1em" viewBox="0 0 40 40" style="vertical-align:middle;display:block;margin:150px auto;animation:fa-spin 2s infinite linear;" preserveAspectRatio="xMidYMid meet" data-reactid=".2fn19shzwg0.1.2.0.0"><g data-reactid=".2fn19shzwg0.1.2.0.0.0"><path d="m11.742857142857144 31.114285714285717q0 1.1857142857142868-0.838571428571429 2.0214285714285687t-2.0199999999999996 0.8371428571428581q-1.161428571428571 0-2.01-0.8471428571428561t-0.845714285714287-2.0114285714285707q0-1.1814285714285724 0.8357142857142854-2.0185714285714305t2.0199999999999996-0.8371428571428581 2.0185714285714287 0.8385714285714272 0.8371428571428563 2.0199999999999996z m11.114285714285714 4.599999999999998q0 1.182857142857145-0.8371428571428581 2.020000000000003t-2.0199999999999996 0.837142857142851-2.0199999999999996-0.8371428571428581-0.8371428571428581-2.019999999999996 0.8371428571428581-2.020000000000003 2.0199999999999996-0.837142857142851 2.0199999999999996 0.8371428571428581 0.8371428571428581 2.019999999999996z m-15.714285714285715-15.714285714285715q8.881784197001252e-16 1.1828571428571415-0.8371428571428563 2.0199999999999996t-2.0200000000000005 0.8371428571428581-2.02-0.8371428571428581-0.837142857142857-2.0199999999999996 0.837142857142857-2.0199999999999996 2.02-0.8371428571428581 2.0200000000000005 0.8371428571428581 0.8371428571428572 2.0199999999999996z m26.828571428571433 11.114285714285714q0 1.1614285714285728-0.8471428571428561 2.009999999999998t-2.008571428571429 0.8485714285714252q-1.1814285714285724 0-2.018571428571427-0.835714285714289t-0.8371428571428581-2.0199999999999996 0.8385714285714272-2.0185714285714305 2.0199999999999996-0.8371428571428581 2.0214285714285687 0.8385714285714272 0.8371428571428581 2.0199999999999996z m-21.514285714285716-22.228571428571428q0 1.4714285714285715-1.0500000000000007 2.5214285714285722t-2.5214285714285722 1.0500000000000007-2.524285714285714-1.0500000000000007-1.0471428571428572-2.5214285714285722 1.0471428571428572-2.524285714285714 2.524285714285714-1.0471428571428572 2.5214285714285722 1.0471428571428572 1.048571428571428 2.522857142857143z m26.11428571428571 11.114285714285714q0 1.1828571428571415-0.8371428571428581 2.0199999999999996t-2.019999999999996 0.8371428571428581-2.020000000000003-0.8371428571428581-0.837142857142851-2.0199999999999996 0.8371428571428581-2.0199999999999996 2.019999999999996-0.8371428571428581 2.020000000000003 0.8371428571428581 0.837142857142851 2.0199999999999996z m-14.285714285714285-15.714285714285715q0 1.7857142857142865-1.25 3.0357142857142865t-3.0357142857142847 1.25-3.0357142857142847-1.25-1.25-3.0357142857142856 1.25-3.0357142857142856 3.0357142857142847-1.25 3.0357142857142847 1.25 1.25 3.0357142857142856z m11.82857142857143 4.600000000000001q0 2.0742857142857147-1.471428571428575 3.5371428571428574t-3.5285714285714214 1.4628571428571426q-2.0742857142857147 0-3.5371428571428574-1.4628571428571426t-1.4628571428571426-3.5371428571428574q0-2.0542857142857143 1.4628571428571426-3.5285714285714285t3.53857142857143-1.4714285714285715q2.0542857142857116 0 3.528571428571432 1.4714285714285715t1.471428571428568 3.5285714285714285z" data-reactid=".2fn19shzwg0.1.2.0.0.0.0"></path></g></svg></div><div class="col-xs-6" data-reactid=".2fn19shzwg0.1.2.1"><pre data-reactid=".2fn19shzwg0.1.2.1.0"><code class="language-jsx" data-reactid=".2fn19shzwg0.1.2.1.0.0">import { default as React, Component } from &quot;react&quot;;
import { default as update } from &quot;react-addons-update&quot;;
import { default as FaSpinner } from &quot;react-icons/lib/fa/spinner&quot;;

import { default as ScriptjsLoader } from &quot;react-google-maps/lib/async/ScriptjsLoader&quot;;
import { GoogleMap, Marker } from &quot;react-google-maps&quot;;

/*
 * This is the modify version of:
 * https://developers.google.com/maps/documentation/javascript/examples/event-arguments
 *
 * Loaded using async loader.
 */
export default class AsyncGettingStarted extends Component {

  static version = Math.ceil(Math.random() * 22);

  state = {
    markers: [{
      position: {
        lat: 25.0112183,
        lng: 121.52067570000001,
      },
      key: `Taiwan`,
      defaultAnimation: 2,
    }],
  }

  /*
   * This is called when you click on the map.
   * Go and try click now.
   */
  handleMapClick(event) {
    let { markers } = this.state;
    markers = update(markers, {
      $push: [
        {
          position: event.latLng,
          defaultAnimation: 2,
          key: Date.now(), // Add a key property for: http://fb.me/react-warning-keys
        },
      ],
    });
    this.setState({ markers });

    if (markers.length === 3) {
      this.props.toast(
        `Right click on the marker to remove it`,
        `Also check the code!`
      );
    }
  }

  handleMarkerRightclick(index, event) {
    /*
     * All you modify is data, and the view is driven by data.
     * This is so called data-driven-development. (And yes, it&#x27;s now in
     * web front end and even with google maps API.)
     */
    let { markers } = this.state;
    markers = update(markers, {
      $splice: [
        [index, 1],
      ],
    });
    this.setState({ markers });
  }

  renderDeprecatedBehavior() {// Remove when reach 5.0.0
    return (
      &lt;ScriptjsLoader
        hostname={&quot;maps.googleapis.com&quot;}
        pathname={&quot;/maps/api/js&quot;}
        query={{ v: `3.${ AsyncGettingStarted.version }`, libraries: `geometry,drawing,places` }}
        loadingElement={
          &lt;div
            {...this.props}
            style={{
              height: `100%`,
            }}
          &gt;
            &lt;FaSpinner
              style={{
                display: `block`,
                margin: `150px auto`,
                animation: `fa-spin 2s infinite linear`,
              }}
            /&gt;
          &lt;/div&gt;
        }
        googleMapElement={
          &lt;GoogleMap
            containerProps={{
              ...this.props,
              style: {
                height: `100%`,
              },
            }}
            ref={googleMap =&gt; {
              // Wait until GoogleMap is fully loaded. Related to #133
              setTimeout(() =&gt; {
                if (!googleMap) {
                  return;
                }
                console.log(googleMap);
                console.log(`Zoom: ` + googleMap.getZoom());
                console.log(`Center: ` + googleMap.getCenter());
              }, 50);
            }}
            defaultZoom={3}
            defaultCenter={{ lat: -25.363882, lng: 131.044922 }}
            onClick={::this.handleMapClick}
          &gt;
            {this.state.markers.map((marker, index) =&gt; {
              return (
                &lt;Marker
                  {...marker}
                  onRightclick={this.handleMarkerRightclick.bind(this, index)}
                /&gt;
              );
            })}
          &lt;/GoogleMap&gt;
        }
      /&gt;
    );
  }

  renderNewBehavior() {
    return (
      &lt;ScriptjsLoader
        hostname={&quot;maps.googleapis.com&quot;}
        pathname={&quot;/maps/api/js&quot;}
        query={{ v: `3.${ AsyncGettingStarted.version }`, libraries: `geometry,drawing,places` }}
        loadingElement={
          &lt;div {...this.props} style={{ height: `100%` }}&gt;
            &lt;FaSpinner
              style={{
                display: `block`,
                margin: `150px auto`,
                animation: `fa-spin 2s infinite linear`,
              }}
            /&gt;
          &lt;/div&gt;
        }
        containerElement={
          &lt;div {...this.props} style={{ height: `100%` }} /&gt;
        }
        googleMapElement={
          &lt;GoogleMap
            ref={googleMap =&gt; {
              if (!googleMap) {
                return;
              }
              console.log(googleMap);
              console.log(`Zoom: ${ googleMap.getZoom() }`);
              console.log(`Center: ${ googleMap.getCenter() }`);
            }}
            defaultZoom={3}
            defaultCenter={{ lat: -25.363882, lng: 131.044922 }}
            onClick={::this.handleMapClick}
          &gt;
            {this.state.markers.map((marker, index) =&gt; {
              return (
                &lt;Marker
                  {...marker}
                  onRightclick={this.handleMarkerRightclick.bind(this, index)}
                /&gt;
              );
            })}
          &lt;/GoogleMap&gt;
        }
      /&gt;
    );
  }

  render() {
    // &lt;script type=&quot;text/javascript&quot; src=&quot;https://maps.googleapis.com/maps/api/js?v=3.exp&amp;libraries=geometry,drawing,places&quot; /&gt;
    // return this.renderDeprecatedBehavior(); // Uncomment for legacy support
    return this.renderNewBehavior();
  }
}
</code></pre></div></div></div></div></div><script src="assets/client-async-6d9aa0d9aa43f1079e36.js"></script></body></html>